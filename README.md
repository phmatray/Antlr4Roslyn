# ANTLR4 to Roslyn Compiler

This project demonstrates the construction of a basic compiler using ANTLR4 and Roslyn to parse, analyze, and generate executable code from mathematical expressions. The project is divided into several core components, leveraging ANTLR4 for syntactic analysis and Roslyn for Abstract Syntax Tree (AST) generation and code compilation.

## Project Structure

- **ANTLR Grammar (`Simple.g4`)**: Defines a grammar for arithmetic expressions.
- **Compiler (`Compiler.cs`)**: Integrates ANTLR for input parsing, Roslyn for AST construction, and compilation into executable code.
- **Visitor (`AntlrToRoslynVisitor.cs`)**: Converts the parse tree generated by ANTLR into a Roslyn syntax tree, which is used to generate C# code.
- **Program Generator (`ProgramGenerator.cs`)**: Generates a complete C# program from the constructed syntax tree.
- **Compilation Service (`CompilationService.cs`)**: Compiles the generated program into an executable or executes it directly in memory.

## How It Works

1. **Define the Grammar**: The grammar is defined in `Simple.g4` to handle basic arithmetic operations, including addition, subtraction, multiplication, and division. The rules incorporate parsing of identifiers, integers, and arithmetic expressions.

2. **Parse Input**: The `Compiler` class reads an input expression (e.g., `3 + 5;`), uses ANTLR4 to parse it into a parse tree, and then visits the nodes of the parse tree to create an equivalent Roslyn syntax tree.

3. **Generate and Compile Code**: The `ProgramGenerator` generates a C# program using Roslyn's syntax factory. The `CompilationService` is then used to compile the generated code into an executable format that can be saved or executed directly.

## Example Usage

To execute the project, run the `Main` method in `Program.cs`:

```sh
$ dotnet run
```

This process will:
- Parse the input `3 + 5;`.
- Convert the parsed input into a C# program using Roslyn.
- Compile the generated program into an executable (`output.exe` or `output` for non-Windows platforms).

## File Details

### `Simple.g4`
This ANTLR4 grammar defines simple arithmetic expressions, including rules for integers, identifiers, and binary operations (`+`, `-`, `*`, `/`).

### `Compiler.cs`
The `Compiler` class orchestrates the entire process: parsing, AST creation, code generation, and compilation. It invokes each major component in sequence:
- Parsing the input using ANTLR.
- Visiting nodes to create a Roslyn syntax tree.
- Generating the program and saving the compiled output.

### `AntlrToRoslynVisitor.cs`
The visitor class extends `SimpleBaseVisitor` to convert each ANTLR parse tree node into an appropriate Roslyn `ExpressionSyntax`. It supports arithmetic operations and identifiers.

### `ProgramGenerator.cs`
The `ProgramGenerator` uses the generated syntax tree and wraps it in a complete C# program, including a `Main` method that outputs the result to the console.

### `CompilationService.cs`
The `CompilationService` handles the compilation and execution of the generated C# program. The `CompileAndSave` method saves the program as an executable, while `CompileAndExecute` can directly execute it in memory.

## Prerequisites

- **.NET SDK 8.0**: Ensure that the latest version of the .NET SDK is installed.
- **ANTLR4 Runtime**: ANTLR4 is used for parsing input expressions.

## How to Build and Run

1. **Clone the Repository**:
   ```sh
   git clone <repository-url>
   cd Antlr4RoslynCompiler
   ```

2. **Run the Compiler**:
   ```sh
   dotnet run
   ```
   This will compile and execute the sample arithmetic expression (`3 + 5;`).

3. **Executable Output**:
   The output executable is saved as `output` (or `output.exe` on Windows).

## Future Improvements

- **Support for More Complex Expressions**: Extend the grammar to handle more advanced mathematical and logical expressions.
- **Error Handling**: Implement more sophisticated error handling during the parsing and compilation phases.
- **User Input**: Allow dynamic user input instead of relying on hardcoded expressions.

## License
This project is open-source and available under the MIT License.

## Contributions
Contributions are encouraged! Feel free to open issues or submit pull requests to add new features or fix existing bugs.

